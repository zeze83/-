<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data cleaning and EDA</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/table1-1.0/table1_defaults.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />
<div class="hero-image"> 
    <div class="image-text">
      <div class="top-text">Data Science Project</div>
        <div class="bottom-text">Regression Analysis on Multiple Factors and Bioindicators of Type II Diabetes</div>
    </div>
</div>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Proposal.html">Proposal</a>
</li>
<li>
  <a href="EDA.html">Exploratory Data Analysis</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Statistical Anaylsis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="modelbuilding.html">Predictive Model Building</a>
    </li>
    <li>
      <a href="statisticalanaylsis.html">Statistics Testing</a>
    </li>
    <li>
      <a href="https://yc3577.shinyapps.io/diabetes_final_project/">Shiny App</a>
    </li>
  </ul>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="mailto:&lt;you@youremail.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/zeze83/p8105_finalproject">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Data cleaning and EDA</h1>

</div>


<div id="data-description" class="section level2">
<h2>Data Description:</h2>
<p>The dataset was collected by the Behavioral Risk Factor Surveillance
System (BRFSS) in 2015. This original dataset contains responses from
441,455 individuals and has 330 features. For this project, we use the
one with 253,680 responses and a three-class diabetes target variable
indicating no diabetes, prediabetes, or diabetes. The potential factors
for diabetes are biological factors such as sex, blood pressure,
cholesterol, BMI, heart disease, social factors such as education and
income, and habits of smoking, physical exercise, eating fruit and
vegetables.</p>
<p>There are 22 variables in our original dataset.</p>
<ul>
<li><p><code>Diabetes_012</code>: This is a categorical variable
indicating the diabetes condition of the individual. 0 is for no
diabetes or only during pregnancy, 1 is for prediabetes, and 2 is for
diabetes.</p></li>
<li><p><code>HighBP</code>: This is a categorical variable indicating
whether or not an individual has high blood pressure. (0 = no, 1 =
yes)</p></li>
<li><p><code>HighChol</code>: This is a categorical variable indicating
whether or not an individual has high blood cholesterol. (0 = no, 1 =
yes)</p></li>
<li><p><code>Cholcheck</code>: This is a categorical variable indicating
whether or not an individual has cholesterol check in 5 years. (0 = no,
1 = yes)</p></li>
<li><p><code>BMI</code>: It is a continuous variable indicating
individual’s Body Mass Index.</p></li>
<li><p><code>Smoker</code>: It is a categorical variable showing
participants identify themselves whether they have smoked at least 100
cigarettes in their entire life. (0 = no, 1 = yes)</p></li>
<li><p><code>Stroke</code>: A categorical variable indicating whether
the individual was told they had a stroke. (0 = no, 1 = yes)</p></li>
<li><p><code>HeartDiseaseorAttack</code>: A categorical variable showing
whether the individual had coronary heart disease (CHD) or myocardial
infarction (MI). (0 = no, 1 = yes)</p></li>
<li><p><code>PhysActivity</code>: A categorical variable showing whether
individual has physical activity in past 30 days which are not included
in job. (0 = no, 1 = yes)</p></li>
<li><p><code>Fruits</code>: A categorical variable showing whether the
individual consumes fruit 1 or more times per day. (0 = no, 1 =
yes)</p></li>
<li><p><code>Veggies</code>: A categorical variable showing whether the
individual consumes vegetables 1 or more times per day. (0 = no, 1 =
yes)</p></li>
<li><p><code>HvyAlcoholConsump</code>: A categorical variable showing
whether the individual is a heavy drinker, which means adult men having
more than 14 drinks per week and adult women having more than 7 drinks
per week. (0 = no, 1 = yes)</p></li>
<li><p><code>AnyHealthcare</code>: A categorical variable showing
whether the individual has any kind of health care coverage, including
health insurance, prepaid plans such as HMO, etc. (0 = no, 1 =
yes)</p></li>
<li><p><code>NoDocbcCost</code>: A categorical variable showing whether
the individual has a time in the past 12 months when he/she needed to
see a doctor but could not because of cost. (0 = no, 1 = yes)</p></li>
<li><p><code>GenHlth</code>: A categorical variable showing the self
evaluation of the individual’s general health. (1 = excellent, 2 = very
good, 3 = good, 4 = fair, 5 = poor)</p></li>
<li><p><code>MentHlth</code>: A categorical variable showing the self
evaluation of the individual was showing mental health problems
including stress, depression, and problems with emotions, for how many
days in their past 30 days.</p></li>
<li><p><code>PhysHlth</code>: A categorical variable showing the self
evaluation of the individual was showing physical health problems, which
includes physical illness and injury, for how many days during the past
30.</p></li>
<li><p><code>DiffWalk</code>: A categorical variable showing the self
evaluation of whether the individual has serious difficulty walking or
climbing stairs. (0 = no, 1 = yes)</p></li>
<li><p><code>Sex</code>: A categorical variable showing the individual’s
born sex. (0 = female, 1 = male)</p></li>
<li><p><code>Age</code>: A categorical variable showing the individual’s
age. (1 = 18-24 9 = 60-64 13 = 80 or older)</p></li>
<li><p><code>Education</code>: A categorical variable showing the
individual’s Education level in the scale of 1-6. [1 = Never attended
school or only kindergarten, 2 = Grades 1 through 8 (Elementary), 3 =
Grades 9 through 11 (Some high school), 4 = Grade 12 or GED (High school
graduate), 5 = College 1 year to 3 years (Some college or technical
school), 6 = College 4 years or more (College graduate)]</p></li>
<li><p><code>Income</code>: A categorical variable showing the
individual’s income level in the scale of 1-8. (1 = less than 10,000
dollars, 5 = less than 35,000 dollars, 8 = 75,000 dollars or
more)</p></li>
</ul>
<p>To explore our question of interest, we will keep
<code>Diabetes_012</code> as our dependent variable, and investigate the
relationship between the other variables and <code>Diabetes_012</code>.
In our hypothesis, biological factors including blood pressure,
cholesterol level, BMI, Heart Disease, age, and sex might have a
relationship with the levels of diabetes, so we keep variables
<code>HighBP</code>, <code>HighChol</code>, <code>BMI</code>,
<code>HeartDiseaseorAttack</code>, <code>Age</code>, and
<code>Sex</code>.</p>
<p>We also predict that social factors including income, education,
smoking habits, alcohol consumption, physical exercise frequency, and
fruit and vegetable eating will be associated with different diabetes
levels. Therefore, we want to keep <code>Income</code>,
<code>Education</code>, <code>Smoker</code>, <code>PhysActivity</code>,
<code>Fruits</code>, <code>HvyAlcoholConsump</code>, and
<code>Veggies</code> variables.</p>
</div>
<div id="read-in-and-clean-data" class="section level2">
<h2>Read in and Clean Data</h2>
<p>First, we read in our data from the csv file.</p>
<pre class="r"><code>diabetes_raw &lt;- read_csv(&quot;data/Diabetes_012_data.csv&quot;)</code></pre>
<pre><code>## Rows: 253680 Columns: 22
## ── Column specification ─────────────────────────
## Delimiter: &quot;,&quot;
## dbl (22): Diabetes_012, HighBP, HighChol, CholCheck, BMI, Smoker, Stroke, He...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>head(diabetes_raw)</code></pre>
<pre><code>## # A tibble: 6 × 22
##   Diabetes_012 HighBP HighChol CholCheck   BMI Smoker Stroke
##          &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1            0      1        1         1    40      1      0
## 2            0      0        0         0    25      1      0
## 3            0      1        1         1    28      0      0
## 4            0      1        0         1    27      0      0
## 5            0      1        1         1    24      0      0
## 6            0      1        1         1    25      1      0
## # ℹ 15 more variables: HeartDiseaseorAttack &lt;dbl&gt;, PhysActivity &lt;dbl&gt;,
## #   Fruits &lt;dbl&gt;, Veggies &lt;dbl&gt;, HvyAlcoholConsump &lt;dbl&gt;, AnyHealthcare &lt;dbl&gt;,
## #   NoDocbcCost &lt;dbl&gt;, GenHlth &lt;dbl&gt;, MentHlth &lt;dbl&gt;, PhysHlth &lt;dbl&gt;,
## #   DiffWalk &lt;dbl&gt;, Sex &lt;dbl&gt;, Age &lt;dbl&gt;, Education &lt;dbl&gt;, Income &lt;dbl&gt;</code></pre>
<pre class="r"><code>diabetes_raw &lt;- diabetes_raw |&gt;
  select(Diabetes_012,HighBP,HighChol, BMI, Smoker, 
         HeartDiseaseorAttack, Sex,Income, Education, 
         PhysActivity, Fruits, Veggies, Age, HvyAlcoholConsump) |&gt;
   mutate(Diabetes_012 = factor(Diabetes_012, levels = c(0, 1, 2), labels = c(&quot;No Diabetes&quot;, &quot;Pre-Diabetes&quot;, &quot;Diabetes&quot;)),
         HighBP = factor(HighBP, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)),
         HighChol = factor(HighChol, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)),
         HeartDiseaseorAttack = factor(HeartDiseaseorAttack, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)),
         Smoker = factor(Smoker, levels = c(0, 1), labels = c(&quot;Nonsmoker&quot;, &quot;Smoker&quot;)),
         Sex = factor(Sex, levels = c(0, 1), labels = c(&quot;Female&quot;, &quot;Male&quot;)),
         Fruits = factor(Fruits, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)),
         Veggies = factor(Veggies, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)),
         HvyAlcoholConsump = factor(HvyAlcoholConsump, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)),
         PhysActivity = factor(PhysActivity, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)))

diabetes_raw</code></pre>
<pre><code>## # A tibble: 253,680 × 14
##    Diabetes_012 HighBP HighChol   BMI Smoker   HeartDiseaseorAttack Sex   Income
##    &lt;fct&gt;        &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;                &lt;fct&gt;  &lt;dbl&gt;
##  1 No Diabetes  Yes    Yes         40 Smoker   No                   Fema…      3
##  2 No Diabetes  No     No          25 Smoker   No                   Fema…      1
##  3 No Diabetes  Yes    Yes         28 Nonsmok… No                   Fema…      8
##  4 No Diabetes  Yes    No          27 Nonsmok… No                   Fema…      6
##  5 No Diabetes  Yes    Yes         24 Nonsmok… No                   Fema…      4
##  6 No Diabetes  Yes    Yes         25 Smoker   No                   Male       8
##  7 No Diabetes  Yes    No          30 Smoker   No                   Fema…      7
##  8 No Diabetes  Yes    Yes         25 Smoker   No                   Fema…      4
##  9 Diabetes     Yes    Yes         30 Smoker   Yes                  Fema…      1
## 10 No Diabetes  No     No          24 Nonsmok… No                   Male       3
## # ℹ 253,670 more rows
## # ℹ 6 more variables: Education &lt;dbl&gt;, PhysActivity &lt;fct&gt;, Fruits &lt;fct&gt;,
## #   Veggies &lt;fct&gt;, Age &lt;dbl&gt;, HvyAlcoholConsump &lt;fct&gt;</code></pre>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>Exploratory Data Analysis</h2>
<div id="bivariate-plots-and-analysis-analysis" class="section level3">
<h3>Bivariate Plots and Analysis Analysis</h3>
<p>We first perform univariate analysis for our dependent variable
<code>Diabetes_012</code> and plot the bivariate relationship between
our interested factors with the diabetes variable respectively.</p>
<div id="distribution-of-diabetes-types" class="section level4">
<h4>Distribution of Diabetes Types</h4>
<pre class="r"><code>Diabetesraw_dist = 
  ggplot(diabetes_raw, aes(Diabetes_012)) + 
  geom_bar(aes(fill = Diabetes_012)) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes Status&quot;) +
  ggtitle(&quot;Raw Overall Diabetes Status Distribution&quot;) +
  theme_minimal()

Diabetesraw_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>From the distribution of Diabetes Status, we realize that
Pre-Diabetes status has extreme low data samples, so we will exclude
this data in our future analysis.</p>
<pre class="r"><code>diabetes_new = 
  diabetes_raw |&gt;
  filter(Diabetes_012 == &#39;Diabetes&#39; | Diabetes_012 == &#39;No Diabetes&#39;) |&gt;
  rename(Diabetes_status = Diabetes_012)

diabetes_new</code></pre>
<pre><code>## # A tibble: 249,049 × 14
##    Diabetes_status HighBP HighChol   BMI Smoker    HeartDiseaseorAttack Sex   
##    &lt;fct&gt;           &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;                &lt;fct&gt; 
##  1 No Diabetes     Yes    Yes         40 Smoker    No                   Female
##  2 No Diabetes     No     No          25 Smoker    No                   Female
##  3 No Diabetes     Yes    Yes         28 Nonsmoker No                   Female
##  4 No Diabetes     Yes    No          27 Nonsmoker No                   Female
##  5 No Diabetes     Yes    Yes         24 Nonsmoker No                   Female
##  6 No Diabetes     Yes    Yes         25 Smoker    No                   Male  
##  7 No Diabetes     Yes    No          30 Smoker    No                   Female
##  8 No Diabetes     Yes    Yes         25 Smoker    No                   Female
##  9 Diabetes        Yes    Yes         30 Smoker    Yes                  Female
## 10 No Diabetes     No     No          24 Nonsmoker No                   Male  
## # ℹ 249,039 more rows
## # ℹ 7 more variables: Income &lt;dbl&gt;, Education &lt;dbl&gt;, PhysActivity &lt;fct&gt;,
## #   Fruits &lt;fct&gt;, Veggies &lt;fct&gt;, Age &lt;dbl&gt;, HvyAlcoholConsump &lt;fct&gt;</code></pre>
<pre class="r"><code>write.csv(diabetes_new, &quot;data/diabetes_new.csv&quot;, row.names = FALSE)

diabetes_new1=diabetes_new|&gt;
  sample_n(200, replace = FALSE)
write.csv(diabetes_new1, &quot;data/diabetes_new1.csv&quot;, row.names = FALSE)</code></pre>
</div>
<div id="high-blood-pressure-via-diabetes" class="section level4">
<h4>1. High Blood Pressure via Diabetes</h4>
<pre class="r"><code>HighBP_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = HighBP), position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes Status&quot;) +
  ggtitle(&quot;HighBP over Diabetes&quot;) +
  theme_minimal()

HighBP_dist</code></pre>
<pre><code>## Warning: The dot-dot notation (`..count..`) was
## deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(count)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to
## see where this warning was generated.</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="high-cholesterol-level-via-diabetes" class="section level4">
<h4>2. High Cholesterol Level via Diabetes</h4>
<pre class="r"><code>HighChol_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = HighChol), position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes Status&quot;) +
  ggtitle(&quot;HighChol over Diabetes&quot;) +
  theme_minimal()

HighChol_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="bmi-via-diabetes" class="section level4">
<h4>3. BMI via Diabetes</h4>
<pre class="r"><code>BMI_dist = 
  ggplot(diabetes_new, aes(BMI, ..count..)) + 
  geom_bar(aes(fill = Diabetes_status)) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;BMI&quot;) +
  ggtitle(&quot;BMI Distribution&quot;) +
  theme_minimal() 

BMI_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="heart-disease-or-attack-via-diabetes" class="section level4">
<h4>4. Heart Disease or Attack via Diabetes</h4>
<pre class="r"><code>Heartdisease_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = HeartDiseaseorAttack), position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes Status&quot;) +
  ggtitle(&quot;Heart Disease over Diabetes&quot;) +
  theme_minimal()

Heartdisease_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="age-via-diabetes" class="section level4">
<h4>5. Age via Diabetes</h4>
<pre class="r"><code>Age_dist = 
  ggplot(diabetes_new, aes(Age, ..count..)) + 
  geom_bar(aes(fill = Diabetes_status)) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Age&quot;) +
  ggtitle(&quot;Age Distribution&quot;) +
  theme_minimal()

Age_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="sex-via-diabetes" class="section level4">
<h4>6. Sex via Diabetes</h4>
<pre class="r"><code>Sex_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = Sex), , position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes&quot;) +
  ggtitle(&quot;Sex over Diabetes Status&quot;) +
  theme_minimal()

Sex_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-10-1.png" width="672" />
#### 7. Income via Diabetes</p>
<pre class="r"><code>Income_dist = 
  ggplot(diabetes_new, aes(Income, ..count..)) + 
  geom_bar(aes(fill = Diabetes_status)) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Income&quot;) +
  ggtitle(&quot;Income Distribution&quot;) +
  theme_minimal()

Income_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="education-via-diabetes" class="section level4">
<h4>8. Education via Diabetes</h4>
<pre class="r"><code>Education_dist = 
  ggplot(diabetes_new, aes(Education, ..count..)) + 
  geom_bar(aes(fill = Diabetes_status)) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Education&quot;) +
  ggtitle(&quot;Education Distribution&quot;) +
  theme_minimal()

Education_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="fruits-via-diabetes" class="section level4">
<h4>9. Fruits via Diabetes</h4>
<pre class="r"><code>Fruits_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = Fruits), , position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes&quot;) +
  ggtitle(&quot;Fruits over Diabetes&quot;) +
  theme_minimal()

Fruits_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-13-1.png" width="672" />
#### 10. Veggies via Diabetes</p>
<pre class="r"><code>Veggies_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = Veggies), , position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes&quot;) +
  ggtitle(&quot;Vegetables over Diabetes&quot;) +
  theme_minimal()

Veggies_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="smoker-via-diabetes" class="section level4">
<h4>11. Smoker via Diabetes</h4>
<pre class="r"><code>Smoker_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = Smoker), , position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes&quot;) +
  ggtitle(&quot;Smokers over Diabetes&quot;) +
  theme_minimal()

Smoker_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-15-1.png" width="672" />
#### 12. PhysActivity via Diabetes</p>
<pre class="r"><code>Physactivity_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = PhysActivity), , position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes&quot;) +
  ggtitle(&quot;PhysActivity over Diabetes&quot;) +
  theme_minimal()

Physactivity_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-16-1.png" width="672" />
#### 13. HvyAlcoholConsump via Diabetes</p>
<pre class="r"><code>HvyAlcohol_dist = 
  ggplot(diabetes_new, aes(Diabetes_status, ..count..)) + 
  geom_bar(aes(fill = HvyAlcoholConsump), , position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Diabetes&quot;) +
  ggtitle(&quot;Alcohol over Diabetes&quot;) +
  theme_minimal()

HvyAlcohol_dist</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div
id="according-to-the-bar-chart-distribution-we-decide-to-drop-heavyalcoholconsumption-heart-disease-attack-these-two-variables-due-to-following-reasons.-1.-for-the-heavy-alcohol-consumption-the-samples-drinking-alcohol-in-large-amount-is-overall-too-few-in-the-sample-so-the-variable-more-not-be-fully-accutately-captured.-therefore-if-we-test-on-this-variable-it-may-be-not-representitive-and-significant.-2.-for-the-heart-disease-attack-it-is-the-same-reason-that-sample-size-with-heart-disease-attack-is-too-small-so-it-may-not-be-representitive-and-meaningful-to-test-on.-we-will-also-drop-age-and-education-these-two-variables-due-to-following-reasons.-1.-for-the-age-the-measure-and-categorize-method-is-not-suitable-for-our-statistical-test-since-it-is-a-categorical-variable-showing-the-individuals-age.-1-18-24-9-60-64-13-80-or-older-and-each-number-does-not-represent-the-true-age-of-the-samples-so-we-cannot-do-a-precise-test-on-it.-2.-for-the-education-it-is-the-same-reason-that-it-is-a-categorical-variable-showing-the-individuals-education-level-in-the-scale-of-1-6.-1-never-attended-school-or-only-kindergarten-2-grades-1-through-8-elementary-3-grades-9-through-11-some-high-school-4-grade-12-or-ged-high-school-graduate-5-college-1-year-to-3-years-some-college-or-technical-school-6-college-4-years-or-more-college-graduate."
class="section level3">
<h3>According to the bar chart distribution, we decide to drop
Heavyalcoholconsumption, heart disease attack these two variables due to
following reasons. 1. For the heavy alcohol consumption, the samples
drinking alcohol in large amount is overall too few in the sample, so
the variable more not be fully accutately captured. Therefore, if we
test on this variable, it may be not representitive and significant. 2.
For the heart disease attack, it is the same reason that sample size
with heart disease attack is too small, so it may not be representitive
and meaningful to test on. We will also drop age and education these two
variables due to following reasons. 1. For the age, the measure and
categorize method is not suitable for our statistical test, since it is
a categorical variable showing the individual’s age. (1 = 18-24 9 =
60-64 13 = 80 or older), and each number does not represent the true age
of the samples, so we cannot do a precise test on it. 2. For the
education, it is the same reason that it is a categorical variable
showing the individual’s Education level in the scale of 1-6. [1 = Never
attended school or only kindergarten, 2 = Grades 1 through 8
(Elementary), 3 = Grades 9 through 11 (Some high school), 4 = Grade 12
or GED (High school graduate), 5 = College 1 year to 3 years (Some
college or technical school), 6 = College 4 years or more (College
graduate)].</h3>
</div>
<div
id="therefore-now-we-come-to-close-with-9-variables-that-are-potential-estimates-in-our-model.-they-are-1.-high-blood-pressure.-2.-high-cholesterol-level.-3.-bmi.-4.-sex.-5.-fruits-consumption.-6.-veggies-consumption.-7.-smoking.-8.-income-level.-9.-physical-acitivity."
class="section level3">
<h3>Therefore, now we come to close with 9 variables that are potential
estimates in our model. They are: 1. High Blood Pressure. 2. High
Cholesterol Level. 3. BMI. 4. Sex. 5. Fruits Consumption. 6. Veggies
Consumption. 7. Smoking. 8. Income Level. 9. Physical Acitivity.</h3>
</div>
</div>
<div id="plots-all-together" class="section level2">
<h2>Plots all together</h2>
<pre class="r"><code>plots1 = plot_grid(
  HighBP_dist + theme(legend.position=&quot;none&quot;),
  HighChol_dist + theme(legend.position=&quot;none&quot;), 
  Fruits_dist + theme(legend.position=&quot;none&quot;), 
  Veggies_dist + theme(legend.position=&quot;none&quot;),
  BMI_dist + theme(legend.position=&quot;none&quot;),
  Sex_dist + theme(legend.position=&quot;none&quot;),
  Income_dist + theme(legend.position=&quot;none&quot;),
  Physactivity_dist + theme(legend.position=&quot;none&quot;),
  Smoker_dist + theme(legend.position=&quot;none&quot;)) +
  theme(axis.text.x = element_text(size = 4))
plots1</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>BMI Categorization</p>
<pre class="r"><code># write a function to categorize bmi values to diverse weight status
categorize_bmi &lt;- function(bmi) {
  if (bmi &lt; 18.5) {
    return(&quot;Underweight&quot;)
  } else if (bmi &gt;= 18.5 &amp; bmi &lt; 25) {
    return(&quot;Normal weight&quot;)
  } else if (bmi &gt;= 25 &amp; bmi &lt; 30) {
    return(&quot;Overweight&quot;)
  } else {
    return(&quot;Obesity&quot;)
  }
}
# add a column named weight_status to the data set
diabetes_raw$weight_status &lt;- sapply(diabetes_raw$BMI, categorize_bmi)</code></pre>
<div
id="plot-association-between-diabetes-status-and-blood-pressure-status"
class="section level4">
<h4>Plot: Association between Diabetes Status and blood pressure
status</h4>
<pre class="r"><code>ggplot(diabetes_raw, aes(x = Diabetes_012, fill = HighBP)) +
  geom_bar(position = &quot;fill&quot;) +
  ylab(&quot;Blood Pressure Status&quot;) +
  xlab(&quot;Diabetes Status&quot;) +
  ggtitle(&quot;Association between Diabetes Status and Blood Pressure Status&quot;) +
  scale_fill_brewer(palette = &quot;Pastel1&quot;) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="plot-association-between-diabetes-status-and-weight-status"
class="section level4">
<h4>Plot: Association between Diabetes Status and Weight Status</h4>
<pre class="r"><code>ggplot(diabetes_raw, aes(x = Diabetes_012, fill = weight_status)) +
  geom_bar(position = &quot;fill&quot;) +
  ylab(&quot;Proportion&quot;) +
  xlab(&quot;Diabetes Status&quot;) +
  ggtitle(&quot;Association between Diabetes Status and Weight Status&quot;) +
  scale_fill_brewer(palette = &quot;Pastel1&quot;) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="plot-box-plot-distribution-of-bmi-in-different-diabetes-status"
class="section level4">
<h4>Plot: Box plot distribution of BMI in different Diabetes status</h4>
<pre class="r"><code>plotBMI = ggplot(diabetes_raw, aes(x = BMI, y = Diabetes_012, fill = Diabetes_012))+
        geom_boxplot(alpha = 0.5) +
        theme(legend.position = &#39;none&#39;) +
        scale_fill_brewer(palette = &#39;Pastel1&#39;) +
        ylab(&quot;Diabetes Status&quot;) +
        xlab(&quot;BMI Distribution&quot;) +
        ggtitle(&quot;Box Plot Distribution of BMI over Diabetes Status&quot;) +
        theme_minimal()
        
  
  
plotBMI</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="plot-smoking-status-over-diabetes-status"
class="section level4">
<h4>Plot: Smoking Status over Diabetes Status</h4>
<pre class="r"><code>plot_smoke = 
  ggplot(diabetes_raw, aes(Smoker, ..count..)) + 
  geom_bar(aes(fill = Diabetes_012), position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Smoking Status&quot;) +
  ggtitle(&quot;Smoking Status Frequencies over Diabetes Status&quot;) +
  theme_minimal()

plot_smoke</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-23-1.png" width="672" />
### Plot: Fruits or Veggies over different Diabetes Status</p>
<pre class="r"><code>mosaicplot(Fruits~Veggies,data=diabetes_raw,col=c(&quot;Light Pink&quot;,&quot;Light Blue&quot;))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div
id="plot-distribution-of-education-level-over-different-diabetes-status"
class="section level4">
<h4>Plot: Distribution of Education Level over different Diabetes
Status</h4>
<pre class="r"><code>plot_education = 
  ggplot(diabetes_raw, aes(x = Education, ..count..)) + 
  geom_bar(aes(fill = Diabetes_012), position = &#39;dodge&#39;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Education Level&quot;) +
  ggtitle(&quot;Education Level Frequencies over Diabetes Status&quot;) +
  theme_minimal()

plot_education</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div
id="plot-distribution-of-income-level-over-different-diabetes-status"
class="section level4">
<h4>Plot: Distribution of Income Level over different Diabetes
Status</h4>
<pre class="r"><code>plot_income = 
  ggplot(diabetes_raw, aes(Income, ..count..)) + 
  geom_bar(aes(fill = Diabetes_012), position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &#39;Pastel1&#39;) +
  ylab(&quot;Frequencies&quot;) +
  xlab(&quot;Income Level&quot;) +
  ggtitle(&quot;Income Level Frequencies over Diabetes Status&quot;) +
  theme_minimal()

plot_income</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="tables" class="section level4">
<h4>Tables</h4>
<pre class="r"><code>pvalue &lt;- function(x, ...) {
    # Construct vectors of data y, and groups (strata) g
    y &lt;- unlist(x)
    g &lt;- factor(rep(1:length(x), times=sapply(x, length)))
    if (is.numeric(y)) {
        # For numeric variables, perform a one-side anova test
        p &lt;- aov(y ~ g)$p.value
    } else {
        # For categorical variables, perform a chi-squared test of independence
        p &lt;- chisq.test(table(y, g))$p.value
    }
    # Format the p-value, using an HTML entity for the less-than sign.
    # The initial empty string places the output on the line below the variable label.
    c(&quot;&quot;, sub(&quot;&lt;&quot;, &quot;&amp;lt;&quot;, format.pval(p, digits=3, eps=0.001)))
}</code></pre>
</div>
<div id="create-r-table-1" class="section level4">
<h4>Create R table 1</h4>
<pre class="r"><code>## Rtable_1 shows the demographics stats
Rtable_1 = 
  table1(~ factor(Sex) + Age| Diabetes_012, data=diabetes_raw, overall=F, extra.col=list(`P-value`=pvalue))

Rtable_1</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>No Diabetes<br><span class='stratn'>(N=213703)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Pre-Diabetes<br><span class='stratn'>(N=4631)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Diabetes<br><span class='stratn'>(N=35346)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>P-value</span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>factor(Sex)</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Female</td>
<td>120959 (56.6%)</td>
<td>2604 (56.2%)</td>
<td>18411 (52.1%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Male</td>
<td class='lastrow'>92744 (43.4%)</td>
<td class='lastrow'>2027 (43.8%)</td>
<td class='lastrow'>16935 (47.9%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'>Age</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>7.79 (3.10)</td>
<td>9.08 (2.63)</td>
<td>9.38 (2.33)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>8.00 [1.00, 13.0]</td>
<td class='lastrow'>9.00 [1.00, 13.0]</td>
<td class='lastrow'>10.0 [1.00, 13.0]</td>
<td class='lastrow'></td>
</tr>
</tbody>
</table>
</div>
<pre class="r"><code>## Rtable_2 shows the physiology status factor stats
Rtable_2 = 
  table1(~ factor(HighBP) + factor(HighChol) + BMI + factor(weight_status) | Diabetes_012, data=diabetes_raw, overall=F, extra.col=list(`P-value`=pvalue))

Rtable_2</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>No Diabetes<br><span class='stratn'>(N=213703)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Pre-Diabetes<br><span class='stratn'>(N=4631)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Diabetes<br><span class='stratn'>(N=35346)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>P-value</span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>factor(HighBP)</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>No</td>
<td>134391 (62.9%)</td>
<td>1718 (37.1%)</td>
<td>8742 (24.7%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Yes</td>
<td class='lastrow'>79312 (37.1%)</td>
<td class='lastrow'>2913 (62.9%)</td>
<td class='lastrow'>26604 (75.3%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'>factor(HighChol)</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>No</td>
<td>132673 (62.1%)</td>
<td>1756 (37.9%)</td>
<td>11660 (33.0%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Yes</td>
<td class='lastrow'>81030 (37.9%)</td>
<td class='lastrow'>2875 (62.1%)</td>
<td class='lastrow'>23686 (67.0%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'>BMI</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>27.7 (6.26)</td>
<td>30.7 (6.96)</td>
<td>31.9 (7.36)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>27.0 [12.0, 98.0]</td>
<td class='lastrow'>30.0 [13.0, 96.0]</td>
<td class='lastrow'>31.0 [13.0, 98.0]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'>factor(weight_status)</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Normal weight</td>
<td>64336 (30.1%)</td>
<td>689 (14.9%)</td>
<td>3928 (11.1%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>Obesity</td>
<td>64906 (30.4%)</td>
<td>2388 (51.6%)</td>
<td>20557 (58.2%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>Overweight</td>
<td>81531 (38.2%)</td>
<td>1526 (33.0%)</td>
<td>10692 (30.2%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>Underweight</td>
<td class='lastrow'>2930 (1.4%)</td>
<td class='lastrow'>28 (0.6%)</td>
<td class='lastrow'>169 (0.5%)</td>
<td class='lastrow'></td>
</tr>
</tbody>
</table>
</div>
<pre class="r"><code>## Rtable_3 shows the social-economic factor stats
Rtable_3 = 
  table1(~ factor(Education) + factor(Income) | Diabetes_012, data=diabetes_raw, overall=F, extra.col=list(`P-value`=pvalue))</code></pre>
<pre><code>## Warning in chisq.test(table(y, g)): Chi-squared approximation may be incorrect</code></pre>
<pre class="r"><code>Rtable_3</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>No Diabetes<br><span class='stratn'>(N=213703)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Pre-Diabetes<br><span class='stratn'>(N=4631)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Diabetes<br><span class='stratn'>(N=35346)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>P-value</span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>factor(Education)</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>1</td>
<td>125 (0.1%)</td>
<td>2 (0.0%)</td>
<td>47 (0.1%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>2</td>
<td>2699 (1.3%)</td>
<td>161 (3.5%)</td>
<td>1183 (3.3%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>3</td>
<td>6868 (3.2%)</td>
<td>314 (6.8%)</td>
<td>2296 (6.5%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>4</td>
<td>50334 (23.6%)</td>
<td>1350 (29.2%)</td>
<td>11066 (31.3%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>5</td>
<td>58223 (27.2%)</td>
<td>1333 (28.8%)</td>
<td>10354 (29.3%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>6</td>
<td class='lastrow'>95454 (44.7%)</td>
<td class='lastrow'>1471 (31.8%)</td>
<td class='lastrow'>10400 (29.4%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'>factor(Income)</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>1</td>
<td>7114 (3.3%)</td>
<td>314 (6.8%)</td>
<td>2383 (6.7%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>2</td>
<td>8341 (3.9%)</td>
<td>356 (7.7%)</td>
<td>3086 (8.7%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>3</td>
<td>12005 (5.6%)</td>
<td>421 (9.1%)</td>
<td>3568 (10.1%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>4</td>
<td>15622 (7.3%)</td>
<td>459 (9.9%)</td>
<td>4054 (11.5%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>5</td>
<td>20792 (9.7%)</td>
<td>587 (12.7%)</td>
<td>4504 (12.7%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>6</td>
<td>30431 (14.2%)</td>
<td>748 (16.2%)</td>
<td>5291 (15.0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>7</td>
<td>37219 (17.4%)</td>
<td>735 (15.9%)</td>
<td>5265 (14.9%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>8</td>
<td class='lastrow'>82179 (38.5%)</td>
<td class='lastrow'>1011 (21.8%)</td>
<td class='lastrow'>7195 (20.4%)</td>
<td class='lastrow'></td>
</tr>
</tbody>
</table>
</div>
<p>We don’t have any healthcare, so drop here</p>
<pre class="r"><code>## Rtable_4 shows the physical-habits factor stats
#Rtable_4 = 
#  table1(~ factor(Smoker) + factor(PhysActivity) + factor(Fruits) + factor(Veggies) + factor(HvyAlcoholConsump) + factor(AnyHealthcare) | Diabetes_012, data=diabetes_raw, overall=F, extra.col=list(`P-value`=pvalue))

#Rtable_4</code></pre>
</div>
<div
id="data-random-sampling-each-500-from-both-diabetes-and-nondiabetes-population.-join-them-together."
class="section level3">
<h3>Data Random sampling each 500 from both diabetes and nondiabetes
population. Join them together.</h3>
<pre class="r"><code>set.seed(123)

diabetes= 
  diabetes_raw |&gt;
  filter(Diabetes_012 == &#39;Diabetes&#39;)
diabetes_sample =
  sample_n(diabetes, size = 500, replace = FALSE)

diabetes_sample</code></pre>
<pre><code>## # A tibble: 500 × 15
##    Diabetes_012 HighBP HighChol   BMI Smoker   HeartDiseaseorAttack Sex   Income
##    &lt;fct&gt;        &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;                &lt;fct&gt;  &lt;dbl&gt;
##  1 Diabetes     Yes    Yes         32 Smoker   No                   Male       7
##  2 Diabetes     Yes    Yes         30 Nonsmok… No                   Male       8
##  3 Diabetes     Yes    Yes         33 Smoker   Yes                  Male       8
##  4 Diabetes     Yes    Yes         38 Smoker   No                   Fema…      3
##  5 Diabetes     Yes    Yes         21 Nonsmok… No                   Fema…      3
##  6 Diabetes     Yes    No          32 Smoker   Yes                  Fema…      7
##  7 Diabetes     Yes    Yes         34 Smoker   No                   Male       1
##  8 Diabetes     Yes    No          30 Smoker   No                   Male       1
##  9 Diabetes     Yes    Yes         21 Smoker   Yes                  Fema…      6
## 10 Diabetes     Yes    Yes         27 Nonsmok… No                   Fema…      6
## # ℹ 490 more rows
## # ℹ 7 more variables: Education &lt;dbl&gt;, PhysActivity &lt;fct&gt;, Fruits &lt;fct&gt;,
## #   Veggies &lt;fct&gt;, Age &lt;dbl&gt;, HvyAlcoholConsump &lt;fct&gt;, weight_status &lt;chr&gt;</code></pre>
<pre class="r"><code>nondiabetes= 
  diabetes_raw |&gt;
  filter(Diabetes_012 == &#39;No Diabetes&#39;)
nondiabetes_sample =
  sample_n(nondiabetes, size = 500, replace = FALSE)

nondiabetes_sample</code></pre>
<pre><code>## # A tibble: 500 × 15
##    Diabetes_012 HighBP HighChol   BMI Smoker   HeartDiseaseorAttack Sex   Income
##    &lt;fct&gt;        &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;                &lt;fct&gt;  &lt;dbl&gt;
##  1 No Diabetes  No     No          30 Smoker   No                   Fema…      8
##  2 No Diabetes  Yes    Yes         28 Smoker   No                   Fema…      6
##  3 No Diabetes  No     Yes         26 Smoker   No                   Male       2
##  4 No Diabetes  No     No          24 Smoker   No                   Fema…      7
##  5 No Diabetes  No     No          26 Nonsmok… No                   Male       7
##  6 No Diabetes  Yes    No          26 Nonsmok… No                   Fema…      6
##  7 No Diabetes  No     Yes         20 Nonsmok… No                   Fema…      3
##  8 No Diabetes  Yes    Yes         34 Nonsmok… No                   Fema…      4
##  9 No Diabetes  No     No          23 Smoker   No                   Male       8
## 10 No Diabetes  No     No          24 Smoker   No                   Fema…      7
## # ℹ 490 more rows
## # ℹ 7 more variables: Education &lt;dbl&gt;, PhysActivity &lt;fct&gt;, Fruits &lt;fct&gt;,
## #   Veggies &lt;fct&gt;, Age &lt;dbl&gt;, HvyAlcoholConsump &lt;fct&gt;, weight_status &lt;chr&gt;</code></pre>
<pre class="r"><code>sample_df = full_join(diabetes_sample, nondiabetes_sample)</code></pre>
<pre><code>## Joining with `by = join_by(Diabetes_012, HighBP,
## HighChol, BMI, Smoker, HeartDiseaseorAttack,
## Sex, Income, Education, PhysActivity, Fruits,
## Veggies, Age, HvyAlcoholConsump, weight_status)`</code></pre>
<pre class="r"><code>sample_df</code></pre>
<pre><code>## # A tibble: 1,000 × 15
##    Diabetes_012 HighBP HighChol   BMI Smoker   HeartDiseaseorAttack Sex   Income
##    &lt;fct&gt;        &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;                &lt;fct&gt;  &lt;dbl&gt;
##  1 Diabetes     Yes    Yes         32 Smoker   No                   Male       7
##  2 Diabetes     Yes    Yes         30 Nonsmok… No                   Male       8
##  3 Diabetes     Yes    Yes         33 Smoker   Yes                  Male       8
##  4 Diabetes     Yes    Yes         38 Smoker   No                   Fema…      3
##  5 Diabetes     Yes    Yes         21 Nonsmok… No                   Fema…      3
##  6 Diabetes     Yes    No          32 Smoker   Yes                  Fema…      7
##  7 Diabetes     Yes    Yes         34 Smoker   No                   Male       1
##  8 Diabetes     Yes    No          30 Smoker   No                   Male       1
##  9 Diabetes     Yes    Yes         21 Smoker   Yes                  Fema…      6
## 10 Diabetes     Yes    Yes         27 Nonsmok… No                   Fema…      6
## # ℹ 990 more rows
## # ℹ 7 more variables: Education &lt;dbl&gt;, PhysActivity &lt;fct&gt;, Fruits &lt;fct&gt;,
## #   Veggies &lt;fct&gt;, Age &lt;dbl&gt;, HvyAlcoholConsump &lt;fct&gt;, weight_status &lt;chr&gt;</code></pre>
</div>
</div>
<div id="covariate-visualisation" class="section level2">
<h2>Covariate visualisation</h2>
<div id="highbp-bmi" class="section level3">
<h3>1. HighBP + BMI</h3>
<pre class="r"><code>ggplot(sample_df, aes(fill=Diabetes_012, y=BMI, x=HighBP)) + 
  geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) +
  ylab(&quot;BMI&quot;) +
  xlab(&quot;Blood Pressure Level&quot;) +
  ggtitle(&quot;Association between HighBP &amp; BMI&quot;) +
  scale_fill_brewer(palette = &quot;Pastel1&quot;) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="highchol-bmi" class="section level3">
<h3>1. HighChol + BMI</h3>
<pre class="r"><code>ggplot(sample_df, aes(fill=Diabetes_012, y=BMI, x=HighChol)) + 
  geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) +
  ylab(&quot;BMI&quot;) +
  xlab(&quot;Cholesterol Level&quot;) +
  ggtitle(&quot;Association between Cholesterol Level &amp; BMI&quot;) +
  scale_fill_brewer(palette = &quot;Pastel1&quot;) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-34-1.png" width="672" />
### Veggies + Fruits vs Physactivity</p>
<div id="high-blood-pressure-in-different-diabetes-status"
class="section level4">
<h4>High Blood Pressure in Different Diabetes Status</h4>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
